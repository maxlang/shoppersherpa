{% extends "base.html.jinja" %}

{% block content %}
<div id="topBar">
    <form id="query" action="/search" method="POST">
        <div id="mainInput">
            {# TODO: there must be a better way to strip whitespace #}
            <input name="keywords" placeholder="product search" value="{{keywords}}" /><span class="link submit">&rarr;</span>
        </div>
    </form>
</div>
<div id="graphArea">
    <div id="attributeTabs">
    {% for attr in attrs|values|sort(attribute='rank') %}
        <div>
        <h1>{{attr.displayName|capitalize}}</h1>
        <div>Rank: {{attr.rank}}</div>
        {% for option in attr.options|sort(attribute='count',reverse=True) %}
            <div>{{option.value}} - {{option.count}}</div>
            <div>Median Price:{{option.stats.price.median}}</div>
            <div>Mean Price:{{option.stats.price.mean}}</div>
            {% if option.stats.ratings_avg is defined %}
                <div>Median Rating:{{option.stats.ratings_avg.median}}</div>
                <div>Mean Rating:{{option.stats.ratings_avg.mean}}</div>
            {% endif %}
        {% endfor %}
        <div>
    {% endfor %}
    </div>
</div>

<div id="rightBar">
<h1>Products</h1>
{% for product in topProducts %}
    {% include "product.html.jinja" %} {# TODO: should this be a macro instead? #}
{% endfor %}
</div>
{% endblock %}